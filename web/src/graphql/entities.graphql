fragment PlayerProps on Player {
  name
  avatar_id
  cash
  status
  location_id
  drug_count
  health
  turn
  max_turns
  max_items
  attack
  defense
  transport
  speed
  wanted
}

query PlayerEntity($gameId: String!, $playerId: String!) {
  entities(keys: [$gameId, $playerId]) {
    total_count
    edges {
      node {
        id
        models {
          __typename
          ... on Player {
            ...PlayerProps
          }
          ... on Drug {
            drug_id
            quantity
          }
          ... on Item{
            item_id
            level
            name
            value
          }
        }
      }
    }
  }
}

subscription PlayerEntitySubscription($id: ID) {
  entityUpdated(id: $id) {
    id
    keys
    model_names
    models {
      __typename
      ... on Player {
        ...PlayerProps
      }
    }
  }
}

subscription PlayerEntityDrugOrItemSubscription($id: ID) {
  entityUpdated(id: $id) {
    id
    keys
    model_names
    models {
      __typename
      ... on Drug {
        drug_id
        quantity
      }
      ... on Item{
        item_id
        level
        name
        value
      }
    }
  }
}



query LocationEntities($gameId: String!, $locationId: String!) {
  entities(keys: [$gameId, $locationId]) {
    total_count
    edges {
      node {
        keys
        models {
          __typename
          ... on Market {
            cash
            quantity
            location_id
            drug_id
          }
        }
      }
      cursor
    }
  }
}

# TODO: Query entire game state per gameId in one query
# query GameState($gameId: String!) {
#   entities (first: 100, keys: [$gameId]]) {
#     total_count
#     edges {
#       node {
#         componentNames
#         components {
#           __typename
#           ... on Game {
#             creator
#             is_finished
#             max_players
#             max_turns
#             num_players
#             start_time
#           }
#           ... on Player {
#             cash
#             health
#             turns_remaining
#           }
#           ... on Drug {
#             quantity
#           }
#           ... on Market {
#             drug_id
#             location_id
#             cash
#             quantity
#           }
#         }
#       }
#     }
#   }
# }

